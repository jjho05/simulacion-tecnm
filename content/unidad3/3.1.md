# 3.1 Conceptos básicos

La generación de variables aleatorias es el proceso fundamental que permite transformar números pseudoaleatorios uniformes $U(0,1)$ en valores que sigan distribuciones de probabilidad específicas. Este proceso es esencial para modelar la incertidumbre y la variabilidad en sistemas reales.

---

## Introducción

En la Unidad 2 aprendimos a generar números pseudoaleatorios uniformes en el intervalo $[0,1]$. Sin embargo, los fenómenos del mundo real rara vez siguen una distribución uniforme:

- Los tiempos entre llegadas de clientes suelen seguir una distribución **Exponencial**
- Las alturas de personas siguen una distribución **Normal**
- El número de defectos en un lote sigue una distribución **Poisson**
- El tiempo de vida de componentes sigue una distribución **Weibull**

**Pregunta clave:** ¿Cómo transformamos un simple número uniforme $U \sim U[0,1]$ en una variable aleatoria $X$ con cualquier distribución deseada?

---

## Variable Aleatoria

### Definición Formal

Una **variable aleatoria** es una función que asigna un valor numérico a cada resultado de un experimento aleatorio.

$$X: \Omega \to \mathbb{R}$$

Donde $\Omega$ es el espacio muestral (conjunto de todos los resultados posibles).

### Ejemplo Conceptual

**Experimento:** Lanzar dos dados

**Espacio muestral:** $\Omega = \{(1,1), (1,2), ..., (6,6)\}$ (36 resultados)

**Variable aleatoria:** $X =$ suma de los dos dados

$$X((3,4)) = 7, \quad X((1,1)) = 2, \quad X((6,6)) = 12$$

### Clasificación

| Tipo | Definición | Ejemplos |
|------|------------|----------|
| **Discreta** | Toma valores contables (finitos o infinitos numerables) | Número de clientes, defectos, llamadas |
| **Continua** | Toma valores en un intervalo continuo | Tiempo, peso, temperatura, distancia |

---

## Función de Probabilidad y Densidad

### Variables Discretas: Función de Masa de Probabilidad (PMF)

Para una variable aleatoria discreta $X$:

$$P(X = x) = p(x)$$

**Propiedades:**
1. $p(x) \geq 0$ para todo $x$
2. $\sum_{x} p(x) = 1$

**Ejemplo: Lanzamiento de dado justo**

$$p(x) = \frac{1}{6}, \quad x \in \{1, 2, 3, 4, 5, 6\}$$

```python
import numpy as np
import matplotlib.pyplot as plt

# PMF de un dado
x = np.arange(1, 7)
p = np.ones(6) / 6

plt.figure(figsize=(10, 6))
plt.stem(x, p, basefmt=' ')
plt.xlabel('Valor (x)')
plt.ylabel('Probabilidad P(X=x)')
plt.title('PMF: Lanzamiento de Dado Justo')
plt.xticks(x)
plt.ylim(0, 0.25)
plt.grid(True, alpha=0.3)
plt.show()
```

### Variables Continuas: Función de Densidad de Probabilidad (PDF)

Para una variable aleatoria continua $X$:

$$P(a \leq X \leq b) = \int_a^b f(x)dx$$

**Propiedades:**
1. $f(x) \geq 0$ para todo $x$
2. $\int_{-\infty}^{\infty} f(x)dx = 1$
3. $P(X = x) = 0$ (probabilidad puntual es cero)

**Ejemplo: Distribución Uniforme $U[0,1]$**

$$f(x) = \begin{cases} 
1 & \text{si } 0 \leq x \leq 1 \\
0 & \text{en otro caso}
\end{cases}$$

```python
# PDF de distribución uniforme
x = np.linspace(-0.5, 1.5, 1000)
f = np.where((x >= 0) & (x <= 1), 1, 0)

plt.figure(figsize=(10, 6))
plt.plot(x, f, linewidth=2)
plt.fill_between(x, f, alpha=0.3)
plt.xlabel('x')
plt.ylabel('f(x)')
plt.title('PDF: Distribución Uniforme U[0,1]')
plt.ylim(-0.1, 1.5)
plt.grid(True, alpha=0.3)
plt.show()
```

---

## Función de Distribución Acumulada (CDF)

### Definición

La **función de distribución acumulada** (CDF) de una variable aleatoria $X$ es:

$$F(x) = P(X \leq x)$$

**Para variables discretas:**
$$F(x) = \sum_{t \leq x} p(t)$$

**Para variables continuas:**
$$F(x) = \int_{-\infty}^{x} f(t)dt$$

### Propiedades Fundamentales

1. **Monotonía:** $F(x)$ es no decreciente
2. **Límites:** 
   - $\lim_{x \to -\infty} F(x) = 0$
   - $\lim_{x \to \infty} F(x) = 1$
3. **Continuidad por la derecha:** $\lim_{h \to 0^+} F(x+h) = F(x)$

### Ejemplo: CDF de Distribución Exponencial

Para $X \sim \text{Exp}(\lambda)$:

**PDF:**
$$f(x) = \lambda e^{-\lambda x}, \quad x \geq 0$$

**CDF:**
$$F(x) = 1 - e^{-\lambda x}, \quad x \geq 0$$

```python
# Comparar PDF y CDF de Exponencial
lambd = 2
x = np.linspace(0, 5, 1000)

pdf = lambd * np.exp(-lambd * x)
cdf = 1 - np.exp(-lambd * x)

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# PDF
ax1.plot(x, pdf, linewidth=2, color='blue')
ax1.fill_between(x, pdf, alpha=0.3)
ax1.set_xlabel('x')
ax1.set_ylabel('f(x)')
ax1.set_title('PDF: Exponencial(λ=2)')
ax1.grid(True, alpha=0.3)

# CDF
ax2.plot(x, cdf, linewidth=2, color='red')
ax2.set_xlabel('x')
ax2.set_ylabel('F(x)')
ax2.set_title('CDF: Exponencial(λ=2)')
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

---

## Relación entre PDF y CDF

### De PDF a CDF (Integración)

$$F(x) = \int_{-\infty}^{x} f(t)dt$$

### De CDF a PDF (Derivación)

$$f(x) = \frac{dF(x)}{dx}$$

**Ejemplo Numérico:**

Para $X \sim U[0,1]$:

**PDF:** $f(x) = 1$ para $x \in [0,1]$

**CDF:** 
$$F(x) = \int_0^x 1 \, dt = x, \quad 0 \leq x \leq 1$$

**Verificación:**
$$\frac{dF(x)}{dx} = \frac{d(x)}{dx} = 1 = f(x) \quad \checkmark$$

---

## Parámetros de una Distribución

### Valor Esperado (Media)

**Discretas:**
$$E[X] = \mu = \sum_{x} x \cdot p(x)$$

**Continuas:**
$$E[X] = \mu = \int_{-\infty}^{\infty} x \cdot f(x)dx$$

**Ejemplo: Dado justo**
$$E[X] = \sum_{x=1}^{6} x \cdot \frac{1}{6} = \frac{1+2+3+4+5+6}{6} = 3.5$$

### Varianza

$$\text{Var}(X) = \sigma^2 = E[(X - \mu)^2] = E[X^2] - (E[X])^2$$

**Ejemplo: Dado justo**
$$E[X^2] = \sum_{x=1}^{6} x^2 \cdot \frac{1}{6} = \frac{1+4+9+16+25+36}{6} = 15.17$$

$$\text{Var}(X) = 15.17 - 3.5^2 = 2.92$$

### Desviación Estándar

$$\sigma = \sqrt{\text{Var}(X)}$$

---

## Objetivo de la Generación de Variables Aleatorias

Dado un número aleatorio $R \sim U(0,1)$, encontrar una **transformación** $X = g(R)$ tal que $X$ siga la distribución deseada.

### Esquema General

```
Generador RNG → R ~ U[0,1] → Transformación g(·) → X ~ f(x)
```

**Ejemplo Conceptual:**

Para generar $X \sim \text{Exp}(\lambda)$:

1. Generar $R \sim U[0,1]$
2. Aplicar transformación: $X = -\frac{1}{\lambda}\ln(1-R)$
3. Resultado: $X \sim \text{Exp}(\lambda)$

```python
def generar_exponencial(lambd, n=1):
    """Genera n variables exponenciales"""
    R = np.random.random(n)
    X = -np.log(1 - R) / lambd
    return X

# Ejemplo
lambd = 2
muestras = generar_exponencial(lambd, n=10000)

# Verificar
print(f"Media teórica: {1/lambd:.4f}")
print(f"Media simulada: {np.mean(muestras):.4f}")
print(f"Varianza teórica: {1/lambd**2:.4f}")
print(f"Varianza simulada: {np.var(muestras):.4f}")

# Histograma
plt.figure(figsize=(10, 6))
plt.hist(muestras, bins=50, density=True, alpha=0.7, edgecolor='black', label='Simulado')

# Superponer PDF teórica
x = np.linspace(0, 5, 1000)
pdf_teorica = lambd * np.exp(-lambd * x)
plt.plot(x, pdf_teorica, 'r-', linewidth=2, label='Teórico')

plt.xlabel('x')
plt.ylabel('Densidad')
plt.title('Generación de Variables Exponenciales')
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()
```

---

## Requisitos para Generación Válida

### 1. Calidad de los Números Base

Los números uniformes $U[0,1]$ deben haber pasado las **pruebas estadísticas** (Unidad 2):
- Pruebas de uniformidad (Chi-cuadrada, Kolmogorov-Smirnov)
- Pruebas de independencia (Corridas, Autocorrelación)

**Razón:** Si los números base son defectuosos, las variables generadas heredarán esos defectos.

### 2. Validez Matemática de la Transformación

La transformación $g(\cdot)$ debe ser **matemáticamente correcta** y preservar las propiedades de la distribución objetivo.

**Ejemplo de transformación inválida:**

❌ **Incorrecto:** $X = R^2$ para generar $\text{Exp}(\lambda)$

✅ **Correcto:** $X = -\frac{1}{\lambda}\ln(1-R)$ para generar $\text{Exp}(\lambda)$

### 3. Verificación Estadística

Las variables generadas deben ser **verificables** mediante:
- Comparación de media y varianza con valores teóricos
- Pruebas de bondad de ajuste (Chi-cuadrada, Kolmogorov-Smirnov)
- Inspección visual (histogramas, Q-Q plots)

```python
def verificar_generador(muestras, distribucion_teorica, nombre=''):
    """
    Verifica la calidad de un generador de variables aleatorias.
    
    Args:
        muestras: Array de valores generados
        distribucion_teorica: Objeto de distribución de scipy.stats
        nombre: Nombre de la distribución para el reporte
    """
    from scipy import stats
    
    print(f"=== VERIFICACIÓN: {nombre} ===\n")
    
    # 1. Estadísticos básicos
    media_sim = np.mean(muestras)
    var_sim = np.var(muestras, ddof=1)
    
    media_teo = distribucion_teorica.mean()
    var_teo = distribucion_teorica.var()
    
    print(f"Media:")
    print(f"  Teórica: {media_teo:.4f}")
    print(f"  Simulada: {media_sim:.4f}")
    print(f"  Error: {abs(media_sim - media_teo):.4f}\n")
    
    print(f"Varianza:")
    print(f"  Teórica: {var_teo:.4f}")
    print(f"  Simulada: {var_sim:.4f}")
    print(f"  Error: {abs(var_sim - var_teo):.4f}\n")
    
    # 2. Prueba de Kolmogorov-Smirnov
    d_stat, p_value = stats.kstest(muestras, distribucion_teorica.cdf)
    
    print(f"Prueba Kolmogorov-Smirnov:")
    print(f"  D estadístico: {d_stat:.4f}")
    print(f"  P-value: {p_value:.4f}")
    print(f"  Resultado: {'✓ PASA' if p_value > 0.05 else '✗ FALLA'}\n")
    
    return {
        'media_error': abs(media_sim - media_teo),
        'var_error': abs(var_sim - var_teo),
        'ks_pvalue': p_value
    }

# Ejemplo de uso
from scipy.stats import expon

muestras_exp = generar_exponencial(lambd=2, n=10000)
dist_teorica = expon(scale=1/2)  # scale = 1/lambda

verificar_generador(muestras_exp, dist_teorica, nombre='Exponencial(λ=2)')
```

---

## Distribuciones de Probabilidad Comunes

### Tabla Resumen

| Distribución | Tipo | Parámetros | Media | Varianza | Uso Típico |
|--------------|------|------------|-------|----------|------------|
| **Uniforme** | Continua | $a, b$ | $\frac{a+b}{2}$ | $\frac{(b-a)^2}{12}$ | Números aleatorios base |
| **Exponencial** | Continua | $\lambda$ | $\frac{1}{\lambda}$ | $\frac{1}{\lambda^2}$ | Tiempos entre eventos |
| **Normal** | Continua | $\mu, \sigma$ | $\mu$ | $\sigma^2$ | Mediciones, errores |
| **Poisson** | Discreta | $\lambda$ | $\lambda$ | $\lambda$ | Conteo de eventos |
| **Binomial** | Discreta | $n, p$ | $np$ | $np(1-p)$ | Éxitos en $n$ ensayos |
| **Weibull** | Continua | $\alpha, \beta$ | $\beta\Gamma(1+1/\alpha)$ | Compleja | Confiabilidad |

---

## Ejercicios Prácticos

### Ejercicio 1: Cálculo de Probabilidades

Dada $X \sim \text{Exp}(\lambda=0.5)$:

1. Calcule $P(X \leq 2)$
2. Calcule $P(1 \leq X \leq 3)$
3. Calcule $E[X]$ y $\text{Var}(X)$

**Solución:**

```python
from scipy.stats import expon

lambd = 0.5
dist = expon(scale=1/lambd)

# 1. P(X <= 2)
p1 = dist.cdf(2)
print(f"P(X ≤ 2) = {p1:.4f}")

# 2. P(1 <= X <= 3)
p2 = dist.cdf(3) - dist.cdf(1)
print(f"P(1 ≤ X ≤ 3) = {p2:.4f}")

# 3. Media y varianza
media = dist.mean()
varianza = dist.var()
print(f"E[X] = {media:.4f}")
print(f"Var(X) = {varianza:.4f}")
```

### Ejercicio 2: Generación y Verificación

Genere 10,000 variables de una distribución Uniforme $U[5, 15]$ y verifique:
1. Media teórica vs simulada
2. Varianza teórica vs simulada
3. Histograma

**Solución:**

```python
def generar_uniforme(a, b, n):
    """Genera n variables uniformes en [a, b]"""
    R = np.random.random(n)
    return a + (b - a) * R

# Generar
a, b = 5, 15
muestras = generar_uniforme(a, b, n=10000)

# Verificar
media_teo = (a + b) / 2
var_teo = (b - a)**2 / 12

print(f"Media teórica: {media_teo:.4f}, Simulada: {np.mean(muestras):.4f}")
print(f"Varianza teórica: {var_teo:.4f}, Simulada: {np.var(muestras):.4f}")

# Histograma
plt.figure(figsize=(10, 6))
plt.hist(muestras, bins=50, density=True, alpha=0.7, edgecolor='black')
plt.axhline(y=1/(b-a), color='r', linestyle='--', linewidth=2, label='Densidad teórica')
plt.xlabel('x')
plt.ylabel('Densidad')
plt.title('Distribución Uniforme U[5,15]')
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()
```

---

## Errores Comunes

### Error 1: Confundir PDF con CDF

❌ **Incorrecto:** Usar $f(x)$ para calcular $P(X \leq x)$

✅ **Correcto:** Usar $F(x) = \int_{-\infty}^{x} f(t)dt$ para calcular $P(X \leq x)$

### Error 2: Asumir $P(X=x) > 0$ para Variables Continuas

❌ **Incorrecto:** $P(X = 2.5) = 0.3$ para $X$ continua

✅ **Correcto:** $P(X = 2.5) = 0$ (probabilidad puntual es cero)

### Error 3: No Validar las Variables Generadas

❌ **Incorrecto:** Generar variables y usarlas sin verificar

✅ **Correcto:** Siempre verificar media, varianza y hacer pruebas de bondad de ajuste

---

## Resumen y Conceptos Clave

**Conceptos Fundamentales:**
- Variable aleatoria: Función que asigna números a resultados aleatorios
- PDF: Describe la densidad de probabilidad (continuas)
- PMF: Describe la probabilidad puntual (discretas)
- CDF: Probabilidad acumulada $P(X \leq x)$

**Objetivo:**
Transformar $U[0,1] \to X \sim f(x)$ mediante métodos matemáticos

**Requisitos:**
1. Números base de calidad (probados)
2. Transformación matemáticamente válida
3. Verificación estadística de resultados

---

*Referencia: Programa SCD-1022 - TecNM*
*Fuentes: Law & Kelton (1991), Ross (2014), Devroye (1986)*


---

<div align="center">

⬅️ [Inicio Unidad 3](README.md) &nbsp;&nbsp;|&nbsp;&nbsp; [3.2 VA Discretas](3.2.md) ➡️

</div>
